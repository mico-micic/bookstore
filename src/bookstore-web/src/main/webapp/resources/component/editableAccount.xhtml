<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:b="http://books.org/bookstore"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsf/composite">

    <body>
        <c:interface>
            <c:attribute name="value" required="true"/>
            <c:attribute name="isNew" /> <!-- default := false -->
        </c:interface>
        <c:implementation>
            <h4><h:outputText value="#{texts.yourDetails}:" /></h4>
            <h:form id="editAccount">
                <h:panelGrid columns="2">
                    <h:outputText value="#{texts.firstName}" />
                    <h:inputText id="firstName" value="#{cc.attrs.value.customer.firstName}" />
                    <h:outputText value="#{texts.lastName}" />
                    <h:inputText id="lastName" value="#{cc.attrs.value.customer.lastName}" />
                    <h:outputText value="#{texts.street}" />
                    <h:inputText id="street" value="#{cc.attrs.value.customer.address.street}" />
                    <h:outputText value="#{texts.postalCode}" />
                    <h:inputText id="postalCode" value="#{cc.attrs.value.customer.address.postalCode}" />
                    <h:outputText value="#{texts.city}" />
                    <h:inputText id="city" value="#{cc.attrs.value.customer.address.city}" />
                    <h:outputText value="#{texts.country}" />
                    <h:inputText id="country" value="#{cc.attrs.value.customer.address.country}" />
                    <h:outputText value="#{texts.email}" />
                    <h:inputText id="email" value="#{cc.attrs.value.customer.email}" />
                </h:panelGrid>

                <h:panelGroup id="passwordGroup" rendered="#{cc.attrs.isNew == true}">
                    <h4><h:outputText value="#{texts.password}:" /></h4>
                    <h:panelGrid columns="2" >
                        <h:outputText value="#{texts.password}" />
                        <h:inputSecret id="password" value="#{cc.attrs.value.customer.password}" />

                        <h:outputText value="#{texts.confirmPassword}" />
                        <h:panelGroup>
                            <h:inputSecret id="passwordConfirm" value="#{cc.attrs.value.customer.password}">
                                <b:validatePassword firstPassFieldId="password" />
                            </h:inputSecret>
                            <div class="elementMessageDiv">
                                <h:message for="passwordConfirm" styleClass="elementMessage" />
                            </div>
                        </h:panelGroup>
                    </h:panelGrid>
                </h:panelGroup>

                <h4><h:outputText value="#{texts.creditCard}:" /></h4>
                <h:panelGrid id="creditCard" columns="2">
                    <h:outputText value="#{texts.type}" />
                    <h:inputText id="creditCardType" value="#{cc.attrs.value.customer.creditCard.type}" />
                    <h:outputLabel for="creditCardNumber" value="#{texts.number}" />
                    <h:panelGroup>
                        <h:inputText id="creditCardNumber" value="#{cc.attrs.value.customer.creditCard.number}" label="#{texts.number}" >
                            <f:converter converterId="org.books.presentation.converter.CreditCardNumberConverter" />
                            <f:validateLength minimum="16" maximum="16" />
                            <b:validateCreditCard cardTypeFieldId="creditCardType" />
                        </h:inputText>
                        <div class="elementMessageDiv">
                            <h:message for="creditCardNumber" styleClass="elementMessage" showSummary="true" showDetail="false" />
                        </div>
                    </h:panelGroup>
                </h:panelGrid>
                <p/>
                <h:commandLink value="#{texts.save}" action="#{cc.attrs.value.updateCustomer}" rendered="#{cc.attrs.isNew == false}" />
                <h:commandLink value="#{texts.register}" action="#{cc.attrs.value.createCustomer}" rendered="#{cc.attrs.isNew == true}"  />
            </h:form>
        </c:implementation>
    </body>

</html>
